<ion-modal-view>
   <ion-header-bar class="bar bar-header ">
       <div class="buttons">
          <button class="button" ng-click="resetForm()">キャンセル</button>
      </div>
      <h1 class="title">メンバーを選択 <span style="font-size:14px;"> ({{$root.addedUsernames.length}})</span></h1>
      <div class="buttons">
          <button class="button" ng-class="{'disabled': $root.addedUsernames==0}" ng-click="createGroupChat()">決定</button>
      </div>
    </ion-header-bar>
    <ion-header-bar class="bar-light bar-subheader" ng-init="userFilter=''">
      <!-- <span style="position: absolute;left: 10px;margin-top: 10px;font-size: 15px;">フィルター:</span> -->
      <input type="search" id="searchUserChat" ng-model="usersToadd" ng-focus="searchFocused = true"
             ng-blur="searchFocused = false" ng-keyup="checkSearch($event)"
             placeholder="フィルター" class="full-width chatsearch">
    </ion-header-bar>
    <ion-content class="has-subheader">
      <ion-item style="padding:0px;padding-left:8px;background:#f0f0f0;">
        <span style="font-size:80%;">選択したメンバー<span>
      </ion-item>
        <div ng-show="$root.addedUsernames.length > 0 || $root.alreadyAdded.length > 0">
           <a ng-show="$root.alreadyAdded.length > 0" class="item item-icon-left" href="" ng-repeat="user in $root.alreadyAdded track by $index">
             <i class="icon ion-ios-checkmark-outline" ></i>
            {{user}}
          </a>
          <a ng-show="$root.addedUsernames.length > 0" class="item item-icon-left" href="" ng-repeat="user in $root.addedUsernames track by $index">
            <i class="icon ion-ios-close-outline" ng-click="removeUserChat($index)"></i>
            {{user}}
          </a>
        </div>
        <ion-item style="padding:0px;padding-left:8px;background:#f0f0f0;">
          <span style="font-size:80%;">メンバー<span>
        </ion-item>
        <div class="list">
            <a class="item item-avatar item-icon-right" href="" ng-click="addUser(user)" ng-repeat="user in users | filter:{User:{username:$root.usersToadd}} track by $index" ng-if="user.User.username">
              <img src="img/avatar.png" ng-show="user.User.avatar_img==''||user.User.avatar_img=='null'||user.User.avatar_img==null">
              <img class="avatar" ng-src="{{base_url}}{{user.User.avatar_img}}" ng-show="user.User.avatar_img!=''&&user.User.avatar_img!='null'&&user.User.avatar_img!=null">
              <h2>{{user.User.username}}</h2>
              <i ng-show="$root.addedUserIds.indexOf(user.User.id) > -1" class="icon ion-checkmark-round"></i>
            </a>
        </div>
        <!-- <ion-infinite-scroll ng-if="numberOfUsersToDisplay < users.length" on-infinite="loadMoreUsers()" distance="1%"></ion-infinite-scroll> -->
    </ion-content>
  </ion-modal-view>
