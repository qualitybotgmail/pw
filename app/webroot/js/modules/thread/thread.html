<style type="text/css">
    .thread-users span.comma:last-child {
        display: 'none';
    }
    .liked {
        font-weight: bolder;
        background: blue;
    }
    .badge-delete .badge,
    .delete-member.badge{
        background-color: #d9534f!important;
    }
    .badge-edit .badge {
        background-color: #2a6496!important;
    }
    .badge-like, .badge-delete,
    .badge-edit,
    .delete-member,
    .add-member {
        cursor: pointer;
    }
    .red {
        color: #d9534f!important;
    }
</style>


<div class="panel colourable" ng-if="thread">
    <div class="panel-heading">
        <span class="panel-title">
            <div>
                <label class="lead">
                    <a ui-sref="app.thread({ id: thread.Thread.id })">
                        {{thread.Thread.title}}
                        <span class="badge add-member" title="Add Head" ng-click="addHead(thread.Thread)">
                            <i class="glyphicon glyphicon-plus"></i>
                        </span>
                    </a>
                </label>
            </div>
            <span>
                <!--投稿メンバー-->
                <span class="thread-users" title="members">
                    
                    <i class="glyphicon glyphicon-plus clickable red" ng-if="thread.Owner.id == loginUser.id" ng-click="addMembers(thread.Thread)"></i>
                    
                    
                    <i class="glyphicon glyphicon-user"></i>
                	<span>:</span>
                	<span ng-if="!thread.User.length">
                		No Member/s
                	</span>
                	<span ng-repeat="u in thread.User" ng-if="thread.User.length">
                		<span 
                            ng-if=" u.id === loginUser.id"
                            class="badge delete-member" 
                            title="Leave Thread" 
                            ng-click="leaveThread($index, u)">
                            <i class="glyphicon glyphicon-log-out"></i>
                        </span>
                        <span 
                            ng-if="thread.Owner.id == loginUser.id"
                            class="badge delete-member" 
                            title="delete member" 
                            ng-click="deleteMember($index, u)">
                            <i class="glyphicon glyphicon-minus"></i>
                        </span>
                        
                		{{u.username}}
                		
                		{{$last ? '' : ', '}}
                	</span>
                </span>
            </span>
            <br>
            <span style="font-size:11px;">
                {{thread.Thread.created}}
            </span>
        </span>
        <div class="panel-heading-controls">
            <input type="checkbox" 
                                id="notification" 
                                ng-model="thread.Thread.push_notification" 
                                data-size="mini"
                                data-label-text="Notification"
                                switch-change="pushNotification()"
                                bootstrap-switch />
            <div class="btn-group btn-group-sm" ng-if="thread.Owner.id == loginUser.id">
                <button class="btn btn-info dropdown-toggle" type="button" data-toggle="dropdown">
                  <span class="fa fa-cog"></span>&nbsp;<span class="fa fa-caret-down"></span>
                </button>
                <ul class="dropdown-menu dropdown-menu-right">
                    <li><a href="" class="clickable" role="button" ng-click="editThread($index, thread)" >編集</a></li>
                    <li><a href="" class="clickable" role="button" ng-click="deleteThread($index, thread.Thread.id)">削除</a></li>
                </ul> <!-- / .dropdown-menu -->
            </div> <!-- / .btn-group -->
        </div> <!-- / .panel-heading-controls -->
    </div> <!-- / .panel-heading -->
    <ul class="list-group">
      <li class="list-group-item" ng-repeat="head in thread.Head">
         <a ui-sref="app.head({ id: head.id })">
            <h5>{{head.body}}</h5>
        </a>
        
        <span style="font-size:10px;">{{head.created}}</span>
        <div class="panel-heading-controls">
            <button class="btn btn-sm {{(head.isUserLiked)?'':'btn-outline'}} btn-warning" ng-disabled="head.processing" ng-click="like($index, head)">
                {{head.likes}}
                <span class="fa fa-thumbs-o-up"></span>
            </button>
            <div class="btn-group btn-group-sm" ng-if="thread.Owner.id == loginUser.id || head.Owner.id == loginUser.id">
              <button class="btn btn-info dropdown-toggle" type="button" data-toggle="dropdown">
                  <span class="fa fa-cog"></span>&nbsp;<span class="fa fa-caret-down"></span>
                </button>
                <ul class="dropdown-menu dropdown-menu-right" >
                    <li><a href="" class="clickable" role="button" ng-click="editHead($index, head)">編集</a></li>
                    <li><a href="" class="clickable" role="button" ng-click="deleteHead($index, head.id)">削除</a></li>
                </ul> <!-- / .dropdown-menu -->
            </div> <!-- / .btn-group -->
        </div> <!-- / .panel-heading-controls -->
      </li>
    </ul>
</div> <!-- / .panel -->



<div ng-repeat="template in templates" ng-include="template"></div>