<style type="text/css">
    .thread-users span.comma:last-child {
        display: 'none';
    }
    .liked {
        font-weight: bolder;
        background: blue;
    }
    .badge-like,
    .add-member {
        cursor: pointer;
    }
    
</style>

<!-- if there is a specific thread show this-->
<div class="row" ng-if="selectedThread">
    <div class="col-xs-12 col-sm-12 col-md-12 col-lg-12">
        <div class="row">
            <div class="col-xs-12 col-sm-12 col-md-12 col-lg-12">
                <p class="thread-users">
                    <span ng-repeat="u in selectedThread.User">
                        {{ u.username }}
                        {{$last ? '' : ', '}}
                        
                    </span>
                    <span class="badge add-member" title="Add member" ng-click="addMembers(selectedThread.Thread)">
                        <i class="glyphicon glyphicon-plus"></i>
                    </span>
                </p>
            </div>        
        </div>
        
        
        <div class="row">
            <div class="col-xs-12 col-sm-12 col-md-12 col-lg-12">
                <div class="detailBox">
                    <div class="titleBox">
                        <h3 class="page-header">
                            {{selectedThread.Thread.title}}
                            <small>
                                <span>
                                    <a class="badge-like" ng-disabled="!selectedThread.Thread.processing" ng-click="like($index, selectedThread)">
                                        <span class="badge {{(selectedThread.Thread.isUserLiked)?'liked':''}}">
                                            {{selectedThread.Thread.likes}}
                                            <i class="glyphicon glyphicon-thumbs-up"></i>
                                        </span>
                                    </a>
                                </span>
                            </small>
                        </h3>
                    </div>
                    <div class="commentBox">
                        <p class="taskDescription">
                             {{selectedThread.Thread.head}}
                             <span ng-repeat="upload in selectedThread.Upload">
                                <a fancybox ng-href="{{upload.path}}">
                                    <img ng-src="{{upload.path}}" class="img-responsive thumbnail" width="150" height="50"></img>
                                </a>
                            </span>
                        </p>
                    </div>
                    <div class="actionBox">
                        <ul class="commentList">
                            <li ng-repeat="c in selectedThread.Comment | unique : 'id'" ng-init="$last && fireMessageEvent()">
                                <div class="commenterImage">
                                  <img src="http://placekitten.com/50/50" />
                                </div>
                                <div class="commentText">
                                    <p>
                                        {{c.body}}
                                        <span ng-repeat="upload in c.Upload">
                                            <a fancybox ng-href="{{upload.path}}">
                                                <img ng-src="{{upload.path}}" class="img-responsive thumbnail" width="150" height="50"></img>
                                            </a>
                                        </span>
                                    </p> 
                                    <span class="date sub-text">
                                        {{c.created}}
                                        
                                        <!--<span>-->
                                        <!--    <a class="badge-like" ng-disabled="c.processing" ng-click="likeComment($index, c)">-->
                                        <!--        <span class="badge {{(c.isUserLiked)?'liked':''}}">-->
                                        <!--            {{c.likes}}-->
                                        <!--            <i class="glyphicon glyphicon-thumbs-up"></i>-->
                                        <!--        </span>-->
                                        <!--    </a>-->
                                        <!--</span>-->
                                        
                                    </span>
                
                                </div>
                            </li>
                        </ul>
                        <form class="form-inline" role="form" id="commentFrm" name="commentFrm" method="POST" enctype="multipart/form-data" 
                        novalidate ng-submit="sendComment(commentFrm.$valid)">
                            <div style="display:none;"><input type="hidden" name="_method" value="POST"/></div>
                            <div class="row hidden">
                                <div class="form-group hidden">
                                    <input type="text" name="data[Upload][comment_id]" id="comment-id" ng-model="comment.comment_id" />
                                </div>
                            </div>
                            
                            <div class="row">
                                <div class="form-group">
                                    <input type="file" name="data[Upload][file]" id="attachments" ng-file-model="comment.filename"  multiple />
                                </div>
                            </div>
                            
                            <div class="row">
                                <div class="form-group">
                                    <textarea name="data[Upload][body]" class="form-control" id="body" placeholder="Comment Here" ng-model="comment.body"></textarea>
                                </div>
                                <div class="form-group">    
                                    <button type="submit" class="btn btn-default" ng-disabled="commentFrm.$invalid">Send</button>
                                </div>
                            </div>
                        </form>
                    </div>
                </div>
            </div>
        </div>
        
    </div>
</div>

<div ng-repeat="template in templates" ng-include="template"></div>